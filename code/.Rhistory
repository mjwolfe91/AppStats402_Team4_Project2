knitr::opts_chunk$set(echo = TRUE)
library(RCurl)
library(dplyr)
library(ggplot2)
heartURL <- getURL("https://raw.githubusercontent.com/mjwolfe91/AppStats402_Team4_Project2/master/data/framingham.csv")
heartData <- read.csv(text=heartURL, header=TRUE)
#heartData <- read.csv('C:/Users/micha/OneDrive/Desktop/SMU MSDS/Applied Stats/Project 2/Data/framingham.csv')
head(heartData)
#https://dplyr.tidyverse.org/reference/recode.html
heartData$male = recode(heartData$male, '1' = 'male', '0' = 'female')
names(heartData)[1] = 'Gender'
unique(heartData$Gender)
heartData$education = recode(heartData$education, '1'='SomeHighSchool', '2'='FinishedHighSchool/GED',
'3'='SomeCollege/VocationalSchool', '4'='College')
unique(heartData$education)
heartData$currentSmoker = recode(heartData$currentSmoker, '1'='Yes', '0'='No')
unique(heartData$currentSmoker)
heartData$BPMeds = recode(heartData$BPMeds, '1'='Yes', '0'='No')
unique(heartData$BPMeds)
unique(heartData$prevalentStroke)
heartData$prevalentStroke = recode(heartData$prevalentStroke, '1'='Yes', '0'='No')
unique(heartData$prevalentHyp)
heartData$prevalentHyp = recode(heartData$prevalentHyp, '1'='Yes', '0'='No')
unique(heartData$TenYearCHD)
heartData$TenYearCHD = recode(heartData$TenYearCHD, '1'='Yes', '0'='No')
unique(heartData$diabetes)
heartData$diabetes = recode(heartData$diabetes, '1'='Yes', '0'='No')
sapply(heartData, class)
cols_factor <- c("Gender", "education", "currentSmoker", "BPMeds", "prevalentStroke", "prevalentHyp", "diabetes", "TenYearCHD")
heartData[cols_factor] <- lapply(heartData[cols_factor], factor)
numeric_cols <- subset(heartData, select = -c(Gender, education, currentSmoker, BPMeds, prevalentStroke, prevalentHyp, diabetes, TenYearCHD))
colSums(numeric_cols)
colSums(is.na(heartData))
summary(heartData)
dim(heartData)
dim(na.omit(heartData))
3658/4240
heartData = na.omit(heartData)
dim(heartData)
summary(heartData)
levels(heartData$TenYearCHD)
heartData$TenYearCHD = relevel(heartData$TenYearCHD, ref='No')
aggregate(glucose~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=glucose)) + geom_boxplot()
aggregate(heartRate~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=heartRate)) + geom_boxplot()
aggregate(BMI~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=BMI)) + geom_boxplot()
aggregate(diaBP~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=diaBP)) + geom_boxplot()
aggregate(sysBP~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=sysBP)) + geom_boxplot()
aggregate(totChol~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=totChol)) + geom_boxplot()
aggregate(cigsPerDay~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=cigsPerDay)) + geom_boxplot()
aggregate(age~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=age)) + geom_boxplot()
for (i in colnames(numeric_cols)){
hist(heartData[[i]])
}
pairs(numeric_cols)
cor(numeric_cols)
prop.table(table(TenYearCHD,diabetes),2)
attach(heartData)
prop.table(table(TenYearCHD,diabetes),2)
plot(TenYearCHD~diabetes,col=c("red","blue"))
#seems to be association between having diabetes and heart disease
#class imbalance
prop.table(table(TenYearCHD,prevalentHyp),2)
plot(TenYearCHD~prevalentHyp,col=c("red","blue"))
#prevalent hypertension associated with heart disease
prop.table(table(TenYearCHD,prevalentStroke),2)
plot(TenYearCHD~prevalentStroke,col=c("red","blue"))
#stroke associated with heart disease
#class imbalance
ftable(addmargins(table(heartData$TenYearCHD,heartData$currentSmoker)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$male)))
prop.table(table(TenYearCHD,BPMeds),2)
plot(TenYearCHD~BPMeds,col=c("red","blue"))
#BP meds associated with heart disease
#class imbalance
prop.table(table(TenYearCHD,currentSmoker),2)
plot(TenYearCHD~currentSmoker,col=c("red","blue"))
prop.table(table(TenYearCHD,education),2)
mosaicplot(TenYearCHD~education, las=1, main = 'Education vs Heart Disease')
prop.table(table(TenYearCHD,currentSmoker),2)
plot(TenYearCHD~Gender,col=c("red","blue"), las=1)
ftable(addmargins(table(heartData$TenYearCHD,heartData$currentSmoker)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$Gender)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$education)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$BPMeds)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$prevalentStroke)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$prevalentHyp)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$diabetes)))
attach(df)
attach(heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=df)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
#seems to be strong linear correlation between systolic BP and diastolic BP, and
#weaker correlation between both and BMI
pairs(numeric_cols)
heartData.cor <- cor(numeric_cols)
heartData.cor
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
df %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData.cor <- heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData.cor
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData.cor <- heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData.cor
heatmap.2(heartData.cor,col=redgreen(75),
density.info="none", trace="none", dendrogram=c("row"),
symm=F,symkey=T,symbreaks=T, scale="none")
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData.cor <- heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData.cor
heatmap.2(heartData.cor,col=redgreen(75),
density.info="none", trace="none", dendrogram=c("row"),
symm=F,symkey=T,symbreaks=T, scale="none")
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData.cor <- heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData.cor
heatmap.2(heartData.cor,col=redgreen(20),
density.info="none", trace="none", dendrogram=c("row"),
symm=F,symkey=T,symbreaks=T, scale="none")
knitr::opts_chunk$set(echo = TRUE)
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
library(randomForest)
install.packages("randomForest")
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
library(randomForest)
knitr::opts_chunk$set(echo = TRUE)
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
library(randomForest)
heartURL <- getURL("https://raw.githubusercontent.com/mjwolfe91/AppStats402_Team4_Project2/master/data/framingham.csv")
heartData <- read.csv(text=heartURL, header=TRUE)
#heartData <- read.csv('C:/Users/micha/OneDrive/Desktop/SMU MSDS/Applied Stats/Project 2/Data/framingham.csv')
head(heartData)
#https://dplyr.tidyverse.org/reference/recode.html
heartData$male = recode(heartData$male, '1' = 'male', '0' = 'female')
names(heartData)[1] = 'Gender'
unique(heartData$Gender)
heartData$education = recode(heartData$education, '1'='SomeHighSchool', '2'='FinishedHighSchool/GED',
'3'='SomeCollege/VocationalSchool', '4'='College')
unique(heartData$education)
heartData$currentSmoker = recode(heartData$currentSmoker, '1'='Yes', '0'='No')
unique(heartData$currentSmoker)
heartData$BPMeds = recode(heartData$BPMeds, '1'='Yes', '0'='No')
unique(heartData$BPMeds)
unique(heartData$prevalentStroke)
heartData$prevalentStroke = recode(heartData$prevalentStroke, '1'='Yes', '0'='No')
unique(heartData$prevalentHyp)
heartData$prevalentHyp = recode(heartData$prevalentHyp, '1'='Yes', '0'='No')
unique(heartData$TenYearCHD)
heartData$TenYearCHD = recode(heartData$TenYearCHD, '1'='Yes', '0'='No')
unique(heartData$diabetes)
heartData$diabetes = recode(heartData$diabetes, '1'='Yes', '0'='No')
sapply(heartData, class)
cols_factor <- c("Gender", "education", "currentSmoker", "BPMeds", "prevalentStroke", "prevalentHyp", "diabetes", "TenYearCHD")
heartData[cols_factor] <- lapply(heartData[cols_factor], factor)
numeric_cols <- subset(heartData, select = -c(Gender, education, currentSmoker, BPMeds, prevalentStroke, prevalentHyp, diabetes, TenYearCHD))
colSums(numeric_cols)
colSums(is.na(heartData))
summary(heartData)
dim(heartData)
dim(na.omit(heartData))
3658/4240
heartData = na.omit(heartData)
dim(heartData)
summary(heartData)
levels(heartData$TenYearCHD)
heartData$TenYearCHD = relevel(heartData$TenYearCHD, ref='No')
aggregate(glucose~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=glucose)) + geom_boxplot()
aggregate(heartRate~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=heartRate)) + geom_boxplot()
aggregate(BMI~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=BMI)) + geom_boxplot()
aggregate(diaBP~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=diaBP)) + geom_boxplot()
aggregate(sysBP~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=sysBP)) + geom_boxplot()
aggregate(totChol~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=totChol)) + geom_boxplot()
aggregate(cigsPerDay~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=cigsPerDay)) + geom_boxplot()
aggregate(age~TenYearCHD, data=heartData, summary)
ggplot(heartData, aes(x=TenYearCHD, y=age)) + geom_boxplot()
for (i in colnames(numeric_cols)){
hist(heartData[[i]])
}
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData)
pairs(~ age + cigsPerDay + totChol + sysBP + diaBP + BMI + heartRate + glucose, data=heartData,
col=TenYearCHD)
heartData.cor <- heartData %>% select(age, cigsPerDay, totChol, sysBP, diaBP, BMI, heartRate, glucose) %>%
cor()
heartData.cor
heatmap.2(heartData.cor,col=redgreen(20),
density.info="none", trace="none", dendrogram=c("row"),
symm=F,symkey=T,symbreaks=T, scale="none")
attach(heartData)
prop.table(table(TenYearCHD,diabetes),2)
plot(TenYearCHD~diabetes,col=c("red","blue"))
prop.table(table(TenYearCHD,prevalentHyp),2)
plot(TenYearCHD~prevalentHyp,col=c("red","blue"))
prop.table(table(TenYearCHD,prevalentStroke),2)
plot(TenYearCHD~prevalentStroke,col=c("red","blue"))
prop.table(table(TenYearCHD,BPMeds),2)
plot(TenYearCHD~BPMeds,col=c("red","blue"))
prop.table(table(TenYearCHD,currentSmoker),2)
plot(TenYearCHD~currentSmoker,col=c("red","blue"))
prop.table(table(TenYearCHD,education),2)
mosaicplot(TenYearCHD~education, las=1, main = 'Education vs Heart Disease')
prop.table(table(TenYearCHD,currentSmoker),2)
plot(TenYearCHD~Gender,col=c("red","blue"), las=1)
ftable(addmargins(table(heartData$TenYearCHD,heartData$currentSmoker)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$Gender)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$education)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$BPMeds)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$prevalentStroke)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$prevalentHyp)))
ftable(addmargins(table(heartData$TenYearCHD,heartData$diabetes)))
pc.result<-prcomp(heartData[,1:15],scale.=TRUE)
?prcomp
pc.result<-prcomp(heartData,scale.=TRUE)
numeric_cols
pc.result<-prcomp(numeric_cols,scale.=TRUE)
numeric_cols <- subset(heartData, select = -c(Gender, education, currentSmoker, BPMeds, prevalentStroke, prevalentHyp, diabetes, TenYearCHD))
pc.result<-prcomp(numeric_cols,scale.=TRUE)
pc.result<-prcomp(numeric_cols,scale.=TRUE)
pc.scores<-pc.result$x
pc.scores<-data.frame(pc.scores)
pc.scores$TenYearCDH<-heartData$TenYearCHD
pc.result<-prcomp(numeric_cols,scale.=TRUE)
pc.scores<-pc.result$x
pc.scores<-data.frame(pc.scores)
pc.scores$TenYearCDH<-heartData$TenYearCHD
ggplot(data = pc.scores, aes(x = PC1, y = PC2)) +
geom_point(aes(col=mpg), size=1)+
ggtitle("PCA of Framingham Heart Disease Data")
pc.result<-prcomp(numeric_cols,scale.=TRUE)
pc.scores<-pc.result$x
pc.scores<-data.frame(pc.scores)
pc.scores$TenYearCDH<-heartData$TenYearCHD
ggplot(data = pc.scores, aes(x = PC1, y = PC2)) +
geom_point(aes(col=TenYearCDH), size=1)+
ggtitle("PCA of Framingham Heart Disease Data")
install.packages("rgl")
p1<-ggplot(heartData,aes(x=TenYearCHD,y=~)
p1<-ggplot(heartData,aes(x=TenYearCHD,y=~))
ggplot(heartData,aes(x=TenYearCHD,y=~))
ggplot(heartData,aes(x=TenYearCHD,y= ~ ))
ggplot(heartData,aes(x=TenYearCHD,y=diaBP))
#p1+geom_point(aes(color=sales))
#p1+geom_point(shape=21,size=2.5)+scale_fill_gradient(low='white', high='blue')
simple.fit<-lm(TenYearCHD~., data=heartData)
plot3d(heartData)
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
library(randomForest)
library(rgl)
library(tree)
install.packages("tree")
library(RCurl)
library(dplyr)
library(ggplot2)
library(gplots)
library(randomForest)
library(rgl)
library(tree)
library(ISLR)
simple.fit<-lm(TenYearCHD~., data=heartData)
plot3d(heartData)
surface3d(0:300,0:50,outer(0:300,0:50,function(x,y) {2.92+.04575*x+.18799*y}),alpha=.4)
short.tree<-tree(TenYearCHD~., data=heartData, mincut=50)
summary(short.tree)
plot(short.tree)
text(short.tree)
rf.car<-randomForest(High~.-Sales,Carseats,subset=train,mtry=5,importance=T,ntree=100)
